<ion-header>
  <ion-toolbar>
    <ion-title>{{ pot ? 'Uredi pot' : 'Dodaj novo pot' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cancel()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding bg-gray-50">
  <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-sm">
    <form [formGroup]="routeForm" (ngSubmit)="save()" class="space-y-6">

      <!-- Name & Duration -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Ime poti *</label>
          <input type="text" formControlName="ime"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
          <div *ngIf="routeForm.get('ime')?.invalid && routeForm.get('ime')?.touched" class="text-red-500 text-xs mt-1">
            Obvezno polje.</div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Priporočen čas (ure ali opis) *</label>
          <input type="text" formControlName="priporocenCas"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
        </div>
      </div>

      <!-- Distance & Difficulty -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Dolžina (km) *</label>
          <input type="number" formControlName="dolzinaKm"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Zahtevnost *</label>
          <select formControlName="tezavnost"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none bg-white">
            <option value="LAHKO">Lahko</option>
            <option value="SREDNJE">Srednje</option>
            <option value="TEZKO">Težko</option>
          </select>
        </div>
      </div>

      <!-- Description -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Opis</label>
        <textarea formControlName="opis" rows="3"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none resize-none"></textarea>
      </div>

      <!-- Kraji Selection -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Kraji (izberite)</label>
        <div class="flex flex-wrap gap-2 max-h-40 overflow-y-auto p-2 border border-gray-200 rounded-md">
          <div *ngFor="let k of kraji" (click)="toggleKraj(k.id)"
            class="cursor-pointer px-3 py-1 rounded-full text-sm border transition-colors select-none"
            [class.bg-blue-100]="isKrajSelected(k.id)" [class.border-blue-300]="isKrajSelected(k.id)"
            [class.text-blue-800]="isKrajSelected(k.id)" [class.bg-gray-50]="!isKrajSelected(k.id)"
            [class.border-gray-200]="!isKrajSelected(k.id)">
            {{ k.ime }}
          </div>
        </div>
      </div>

      <!-- Zanimivosti Selection -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Zanimivosti (izberite)</label>
        <div class="flex flex-wrap gap-2 max-h-40 overflow-y-auto p-2 border border-gray-200 rounded-md">
          <div *ngFor="let z of zanimivosti" (click)="toggleZanimivost(z.id)"
            class="cursor-pointer px-3 py-1 rounded-full text-sm border transition-colors select-none"
            [class.bg-purple-100]="isZanimivostSelected(z.id)" [class.border-purple-300]="isZanimivostSelected(z.id)"
            [class.text-purple-800]="isZanimivostSelected(z.id)" [class.bg-gray-50]="!isZanimivostSelected(z.id)"
            [class.border-gray-200]="!isZanimivostSelected(z.id)">
            {{ z.ime }}
          </div>
        </div>
      </div>

      <!-- Footer Buttons -->
      <div class="flex justify-end gap-3 pt-4 border-t border-gray-200">
        <button type="button" (click)="cancel()"
          class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg">Prekliči</button>
        <button type="submit" [disabled]="routeForm.invalid"
          class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm disabled:opacity-50">
          <ion-icon name="save-outline" class="mr-2"></ion-icon>
          Shrani pot
        </button>
      </div>

    </form>
  </div>
</ion-content>