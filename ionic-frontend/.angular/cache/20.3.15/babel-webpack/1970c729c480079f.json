{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/TejWork/Desktop/Music/Projekt/Seznam-kolesarskih-poti-v-Sloveniji- - Copy/ionic-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"src/app/services/api.service\";\nimport * as i4 from \"src/app/services/auth.service\";\nimport * as i5 from \"@angular/common\";\nfunction RouteEditorComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵtext(1, \" Obvezno polje.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RouteEditorComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵlistener(\"click\", function RouteEditorComponent_div_43_Template_div_click_0_listener() {\n      const k_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.toggleKraj(k_r2.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const k_r2 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"bg-blue-100\", ctx_r2.isKrajSelected(k_r2.id))(\"border-blue-300\", ctx_r2.isKrajSelected(k_r2.id))(\"text-blue-800\", ctx_r2.isKrajSelected(k_r2.id))(\"bg-gray-50\", !ctx_r2.isKrajSelected(k_r2.id))(\"border-gray-200\", !ctx_r2.isKrajSelected(k_r2.id));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", k_r2.ime, \" \");\n  }\n}\nfunction RouteEditorComponent_div_48_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵlistener(\"click\", function RouteEditorComponent_div_48_Template_div_click_0_listener() {\n      const z_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.toggleZanimivost(z_r5.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const z_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"bg-purple-100\", ctx_r2.isZanimivostSelected(z_r5.id))(\"border-purple-300\", ctx_r2.isZanimivostSelected(z_r5.id))(\"text-purple-800\", ctx_r2.isZanimivostSelected(z_r5.id))(\"bg-gray-50\", !ctx_r2.isZanimivostSelected(z_r5.id))(\"border-gray-200\", !ctx_r2.isZanimivostSelected(z_r5.id));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", z_r5.ime, \" \");\n  }\n}\nexport let RouteEditorComponent = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class RouteEditorComponent {\n    constructor(modalCtrl, fb, apiService, authService, toastCtrl) {\n      this.modalCtrl = modalCtrl;\n      this.fb = fb;\n      this.apiService = apiService;\n      this.authService = authService;\n      this.toastCtrl = toastCtrl;\n      this.kraji = [];\n      this.zanimivosti = [];\n      this.selectedKraji = [];\n      this.selectedZanimivosti = [];\n      this.routeForm = this.fb.group({\n        ime: ['', Validators.required],\n        dolzinaKm: ['', [Validators.required, Validators.min(0)]],\n        tezavnost: ['LAHKO', Validators.required],\n        priporocenCas: ['', Validators.required],\n        opis: ['']\n      });\n    }\n    ngOnInit() {\n      this.loadData();\n      if (this.pot) {\n        this.routeForm.patchValue({\n          ime: this.pot.ime,\n          dolzinaKm: this.pot.dolzinaKm,\n          tezavnost: this.pot.tezavnost,\n          priporocenCas: this.pot.priporocenCas,\n          // Assuming string provided, need to match\n          opis: this.pot.opis\n        });\n        this.selectedKraji = this.pot.kraji.map(k => k.id);\n        this.selectedZanimivosti = this.pot.zanimivosti.map(z => z.id);\n      }\n    }\n    loadData() {\n      this.apiService.pridobiVseKraje().subscribe(data => this.kraji = data);\n      this.apiService.pridobiVseZanimivosti().subscribe(data => this.zanimivosti = data);\n    }\n    toggleKraj(id) {\n      const index = this.selectedKraji.indexOf(id);\n      if (index > -1) {\n        this.selectedKraji.splice(index, 1);\n      } else {\n        this.selectedKraji.push(id);\n      }\n    }\n    toggleZanimivost(id) {\n      const index = this.selectedZanimivosti.indexOf(id);\n      if (index > -1) {\n        this.selectedZanimivosti.splice(index, 1);\n      } else {\n        this.selectedZanimivosti.push(id);\n      }\n    }\n    isKrajSelected(id) {\n      return this.selectedKraji.includes(id);\n    }\n    isZanimivostSelected(id) {\n      return this.selectedZanimivosti.includes(id);\n    }\n    cancel() {\n      return this.modalCtrl.dismiss(null, 'cancel');\n    }\n    save() {\n      if (this.routeForm.valid) {\n        const user = this.authService.currentUserValue;\n        if (!user) return;\n        const formValue = this.routeForm.value;\n        const potDTO = {\n          ...formValue,\n          priporocenCas: formValue.priporocenCas.toString(),\n          // Ensure string based on my decision before (or number if backend expects it to be casted?) Backend DTO is string.\n          uporabnikId: user.id,\n          krajiIds: this.selectedKraji,\n          znamenitostiIds: this.selectedZanimivosti\n        };\n        if (this.pot) {\n          // Edit logic\n          this.apiService.urediPot(this.pot.id, potDTO).subscribe({\n            next: () => this.modalCtrl.dismiss('saved', 'saved'),\n            error: err => this.showError(err)\n          });\n        } else {\n          // Create logic\n          this.apiService.vnosPoti(potDTO).subscribe({\n            next: () => this.modalCtrl.dismiss('saved', 'saved'),\n            error: err => this.showError(err)\n          });\n        }\n      } else {\n        this.routeForm.markAllAsTouched();\n      }\n    }\n    showError(err) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const toast = yield _this.toastCtrl.create({\n          message: 'Napaka pri shranjevanju: ' + (err.error?.message || err.message),\n          duration: 3000,\n          color: 'danger'\n        });\n        toast.present();\n      })();\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function RouteEditorComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || RouteEditorComponent)(i0.ɵɵdirectiveInject(i1.ModalController), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.ApiService), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i1.ToastController));\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: RouteEditorComponent,\n      selectors: [[\"app-route-editor\"]],\n      inputs: {\n        pot: \"pot\"\n      },\n      decls: 55,\n      vars: 6,\n      consts: [[\"slot\", \"end\"], [3, \"click\"], [\"name\", \"close\"], [1, \"ion-padding\", \"bg-gray-50\"], [1, \"max-w-2xl\", \"mx-auto\", \"bg-white\", \"p-6\", \"rounded-lg\", \"shadow-sm\"], [1, \"space-y-6\", 3, \"ngSubmit\", \"formGroup\"], [1, \"grid\", \"grid-cols-1\", \"md:grid-cols-2\", \"gap-4\"], [1, \"block\", \"text-sm\", \"font-medium\", \"text-gray-700\", \"mb-1\"], [\"type\", \"text\", \"formControlName\", \"ime\", 1, \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"focus:ring-2\", \"focus:ring-blue-500\", \"focus:outline-none\"], [\"class\", \"text-red-500 text-xs mt-1\", 4, \"ngIf\"], [\"type\", \"text\", \"formControlName\", \"priporocenCas\", 1, \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"focus:ring-2\", \"focus:ring-blue-500\", \"focus:outline-none\"], [\"type\", \"number\", \"formControlName\", \"dolzinaKm\", 1, \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"focus:ring-2\", \"focus:ring-blue-500\", \"focus:outline-none\"], [\"formControlName\", \"tezavnost\", 1, \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"focus:ring-2\", \"focus:ring-blue-500\", \"focus:outline-none\", \"bg-white\"], [\"value\", \"LAHKO\"], [\"value\", \"SREDNJE\"], [\"value\", \"TEZKO\"], [\"formControlName\", \"opis\", \"rows\", \"3\", 1, \"w-full\", \"px-3\", \"py-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"focus:ring-2\", \"focus:ring-blue-500\", \"focus:outline-none\", \"resize-none\"], [1, \"block\", \"text-sm\", \"font-medium\", \"text-gray-700\", \"mb-2\"], [1, \"flex\", \"flex-wrap\", \"gap-2\", \"max-h-40\", \"overflow-y-auto\", \"p-2\", \"border\", \"border-gray-200\", \"rounded-md\"], [\"class\", \"cursor-pointer px-3 py-1 rounded-full text-sm border transition-colors select-none\", 3, \"bg-blue-100\", \"border-blue-300\", \"text-blue-800\", \"bg-gray-50\", \"border-gray-200\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"cursor-pointer px-3 py-1 rounded-full text-sm border transition-colors select-none\", 3, \"bg-purple-100\", \"border-purple-300\", \"text-purple-800\", \"bg-gray-50\", \"border-gray-200\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"flex\", \"justify-end\", \"gap-3\", \"pt-4\", \"border-t\", \"border-gray-200\"], [\"type\", \"button\", 1, \"px-4\", \"py-2\", \"bg-gray-100\", \"hover:bg-gray-200\", \"text-gray-700\", \"rounded-lg\", 3, \"click\"], [\"type\", \"submit\", 1, \"px-4\", \"py-2\", \"bg-blue-600\", \"hover:bg-blue-700\", \"text-white\", \"rounded-lg\", \"shadow-sm\", \"disabled:opacity-50\", 3, \"disabled\"], [\"name\", \"save-outline\", 1, \"mr-2\"], [1, \"text-red-500\", \"text-xs\", \"mt-1\"], [1, \"cursor-pointer\", \"px-3\", \"py-1\", \"rounded-full\", \"text-sm\", \"border\", \"transition-colors\", \"select-none\", 3, \"click\"]],\n      template: function RouteEditorComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n          i0.ɵɵtext(3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"ion-buttons\", 0)(5, \"ion-button\", 1);\n          i0.ɵɵlistener(\"click\", function RouteEditorComponent_Template_ion_button_click_5_listener() {\n            return ctx.cancel();\n          });\n          i0.ɵɵelement(6, \"ion-icon\", 2);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(7, \"ion-content\", 3)(8, \"div\", 4)(9, \"form\", 5);\n          i0.ɵɵlistener(\"ngSubmit\", function RouteEditorComponent_Template_form_ngSubmit_9_listener() {\n            return ctx.save();\n          });\n          i0.ɵɵelementStart(10, \"div\", 6)(11, \"div\")(12, \"label\", 7);\n          i0.ɵɵtext(13, \"Ime poti *\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(14, \"input\", 8);\n          i0.ɵɵtemplate(15, RouteEditorComponent_div_15_Template, 2, 0, \"div\", 9);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"div\")(17, \"label\", 7);\n          i0.ɵɵtext(18, \"Priporo\\u010Den \\u010Das (ure ali opis) *\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(19, \"input\", 10);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(20, \"div\", 6)(21, \"div\")(22, \"label\", 7);\n          i0.ɵɵtext(23, \"Dol\\u017Eina (km) *\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(24, \"input\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"div\")(26, \"label\", 7);\n          i0.ɵɵtext(27, \"Zahtevnost *\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"select\", 12)(29, \"option\", 13);\n          i0.ɵɵtext(30, \"Lahko\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"option\", 14);\n          i0.ɵɵtext(32, \"Srednje\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(33, \"option\", 15);\n          i0.ɵɵtext(34, \"Te\\u017Eko\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(35, \"div\")(36, \"label\", 7);\n          i0.ɵɵtext(37, \"Opis\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(38, \"textarea\", 16);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"div\")(40, \"label\", 17);\n          i0.ɵɵtext(41, \"Kraji (izberite)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(42, \"div\", 18);\n          i0.ɵɵtemplate(43, RouteEditorComponent_div_43_Template, 2, 11, \"div\", 19);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(44, \"div\")(45, \"label\", 17);\n          i0.ɵɵtext(46, \"Zanimivosti (izberite)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(47, \"div\", 18);\n          i0.ɵɵtemplate(48, RouteEditorComponent_div_48_Template, 2, 11, \"div\", 20);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(49, \"div\", 21)(50, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function RouteEditorComponent_Template_button_click_50_listener() {\n            return ctx.cancel();\n          });\n          i0.ɵɵtext(51, \"Prekli\\u010Di\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(52, \"button\", 23);\n          i0.ɵɵelement(53, \"ion-icon\", 24);\n          i0.ɵɵtext(54, \" Shrani pot \");\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          let tmp_2_0;\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(ctx.pot ? \"Uredi pot\" : \"Dodaj novo pot\");\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"formGroup\", ctx.routeForm);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_2_0 = ctx.routeForm.get(\"ime\")) == null ? null : tmp_2_0.invalid) && ((tmp_2_0 = ctx.routeForm.get(\"ime\")) == null ? null : tmp_2_0.touched));\n          i0.ɵɵadvance(28);\n          i0.ɵɵproperty(\"ngForOf\", ctx.kraji);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngForOf\", ctx.zanimivosti);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"disabled\", ctx.routeForm.invalid);\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf, i1.IonButton, i1.IonButtons, i1.IonContent, i1.IonHeader, i1.IonIcon, i1.IonTitle, i1.IonToolbar, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.NumberValueAccessor, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n      encapsulation: 2\n    }));\n  }\n  _staticBlock();\n  return RouteEditorComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}